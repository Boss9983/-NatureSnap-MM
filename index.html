// get-submissions.js
const fetch = require('node-fetch');

exports.handler = async function(event, context) {
  const response = await fetch("https://api.netlify.com/api/v1/forms/<your-form-id>/submissions", {
    headers: {
      "Authorization": "Bearer <your-access-token>"
    }
  });

  const submissions = await response.json();

  const formatted = submissions.map(sub => ({
    name: sub.data["Your Name"],
    phone: sub.data["Phone Number"],
    photo: sub.data["Upload Your Photo"][0].url
  }));

  return {
    statusCode: 200,
    body: JSON.stringify(formatted)
  };
};
